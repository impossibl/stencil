---
layout: default
title: Macros - Stencil
---
<style>
	pre {
		background-color: #ddd;
		border-radius: 5px;
		
	}
	pre.decl {
		color: #0000ff;
	}
	pre.input {
		width: 350px;
		margin-right: 15px;
		float: left;
	}
	pre.output {
		background-color: #ccc;
		color: #ff00ff;
	}
	p {
		clear: both;
	}
</style>

<h1>Macros</h1>

<p>
	A macro is a block of text that can be executed after it's defined. Essentially it is a mini template
	defined inside the template file.
</p>
<p>
	This allows things like repeating the same block of text without retyping it.  The real power of macros
	 is that they can accept parameters and	even be passed blocks of text very easily; all of which is
	 described below.  Also to keep in mind is that the template file itself can be executed like a macro
	 from another macro using the <a href="outputs.html#include">include</a> output command.
</p>

<h2>Basic</h2>
<p>
	Defining a macro in Stencil is done with this simple syntax
	<pre class="decl">
	$macro myMacro () {
		My Macro!
	};
	</pre>
	<pre class="input">
	$myMacro ();
	</pre>
	<pre class="output">
	My Macro!
	</pre>
</p>

<h2>Parameters</h2>
<p>
	Parameters are specified in familiar parentheses format. Remember, Stencil is an untyped language so no
	types are specified, just names.
	<pre class="decl">
	$macro myMacro ( greeting, name ) {
		$greeting; $name;!
	};
	</pre>
	<pre class="input">
	$myMacro('Hello','World');
	</pre>
	<pre class="output">
	Hello World!
	</pre>
</p>
<p>
	Parameters can be passed by location (as in the previous example) or by name. You must choose one passing
	method or the other. You cannot mix methods.
	<pre class="decl">
	$macro myMacro ( greeting, name ) {
		$greeting; $name;!
	};
	</pre>
	<pre class="input">
$myMacro(greeting='Hello',name='World');
	</pre>
	<pre class="output">
	Hello World!
	</pre>
</p>

<h3>Default Values</h3>
<p>
	Parameters can also have default values. You simply specify an <a href="expressions.html">expression</a>
	after the parameter name. Any parameters not passed will receive their default value or null if no
	default was defined.
	<pre class="decl">
	$macro myMacro ( greeting='Hello', name ) {
		$greeting; $name;!
	};
	</pre>
	<pre class="input">
	$myMacro(name='World');
	</pre>
	<pre class="output">
	Hello World!
	</pre>
</p>

<h3>Any Parameters</h3>
<p>
	Occasionally you would like to accept any number of parameters and process them all in your macro. This
	is done by marking a parameter with the '*' sign.  Then you can enumerate the parameter keys/values at
	will.
	<pre class="decl">
	$macro myMacro (*all) {
		$foreach entry in all {
			$entry.key = $entry.value;
		};
	};
	</pre>
	<pre class="input">
$myMacro(one='blue',two='red',three='green');
	</pre>
	<pre class="output">
	one = blue;
	two = red;
	three = green;
	</pre>
</p>

<h2><a id="blocks">Blocks</a></h2>
<p>
	Macros can also accept named blocks. Square brackets after the parameter declaration list allow you to
	declare the names of blocks the macro can take.
	<pre class="decl">
	$macro myMacro ( greeting, name ) [ header, footer ] {
		$headerBlock;
		
		$greeting; $name;
		
		$footerBlock;
	};
	</pre>
</p>
<p>
	Blocks are passed to the macro by simply naming blocks of text after you call the macro.
	<pre class="input">
	$myMacro ('Hello', 'World')
		header {
			&lt;div&gt;
		}
		footer {
			&lt;div&gt;
		};
	</pre>
	<pre class="output">
	&lt;div&gt;
	Hello World!
	&lt;/div&gt;
	</pre>
</p>

<h3>Unnamed Block</h3>
<p>
	In some cases, like when a macro needs to only accept a single macro, you can skip name when passing
	the block.  In the block declaration list you specify what name to give the block with the '+' sign.
	<pre class="decl">
	$macro myMacro ( greeting, name ) [ +block ] {

		$greeting; $name;
		
		$block;		
	};
	</pre>
	<pre class="input">
	$myMacro ('Hello', 'World') {
		Some Extra Text
	};
	</pre>
	<pre class="output">
	Hello World!
	
	Some Extra Text
	</pre>
</p>

<h3>Block Modes</h3>
<p>
	Sometimes just replacing the value in a block is too trivial.  A macro can provide default text for a
	block.  When passing a block you can specify how that default text is handled with the following
	modes:
		<ul>
			<li>before</li>
			<li>after</li>
			<li>replace</li>
		</ul>
	Specifying 'before' places the passed block's contents before the default text, 'after' places it after
	the default text and 'replace' replaces the default text. Replace is the mode used when no mode is specified
	<pre class="decl">
	$macro myMacro () [ pleading ] {
		Modes are neat...
		$pleading {
			Don't replace me!
		};
	};
	</pre>
	<pre class="input">
	$myMacro ()
		after pleading {
			Some Extra Text
		};
	</pre>
	<pre class="output">
	Modes are neat...
	Don't replace me!
	Some Extra Text
	</pre>
</p>